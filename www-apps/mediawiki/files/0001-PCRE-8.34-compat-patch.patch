From 55c5ec96ffa947b5db40ac397875304ba29b3201 Mon Sep 17 00:00:00 2001
From: Kevin Israel <pleasestand@live.com>
Date: Thu, 19 Dec 2013 05:36:36 -0500
Subject: [PATCH] Quick and dirty PCRE 8.34 compat patch

Change-Id: I3814fd09e246139118b6a1e6e28f49dd5d418c6f
---
 includes/MagicWord.php | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/includes/MagicWord.php b/includes/MagicWord.php
index 427a1ad..cd26f21 100644
--- a/includes/MagicWord.php
+++ b/includes/MagicWord.php
@@ -709,7 +709,7 @@ class MagicWordArray {
 				$magic = MagicWord::get( $name );
 				$case = intval( $magic->isCaseSensitive() );
 				foreach ( $magic->getSynonyms() as $i => $syn ) {
-					$group = "(?P<{$i}_{$name}>" . preg_quote( $syn, '/' ) . ')';
+					$group = "(?P<_{$i}_{$name}>" . preg_quote( $syn, '/' ) . ')';
 					if ( $this->baseRegex[$case] === '' ) {
 						$this->baseRegex[$case] = $group;
 					} else {
@@ -805,6 +805,9 @@ class MagicWordArray {
 			if ( $key === 0 || $value === '' ) {
 				continue;
 			}
+			if ( $key[0] === '_' ) {
+				$key = substr( $key, 1 );
+			}
 			$parts = explode( '_', $key, 2 );
 			if ( count( $parts ) != 2 ) {
 				// This shouldn't happen
-- 
1.8.4.4

